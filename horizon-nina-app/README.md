# Horizon NINA App

Aplicación Expo React Native para capturar y exportar perfiles de horizonte compatibles con N.I.N.A. funcionando completamente offline.

## Requisitos
- Node.js LTS
- Cuenta de Expo (para EAS Build/Update)
- Expo Go (dispositivo móvil)

## Desarrollo
```bash
npm install
npm start
```
Escanea el QR con Expo Go.

## Publicación (EAS Update)
Actualizaciones OTA (sin pasar por tiendas):
```bash
npx eas login             # inicia sesión en Expo
npm run update:preview    # canal preview
npm run update:prod       # canal production
```

## Build de tiendas (EAS Build)
Genera binarios para Android/iOS:
```bash
npx eas login
npm run build:android     # genera AAB para Play Store
npm run build:ios         # genera IPA (requiere cuenta Apple)
```

Los ajustes de perfiles están en `eas.json`. El identificador de paquete está en `app.json` (`ios.bundleIdentifier`, `android.package`).

## Exportación de Horizonte
- En la app, usa "Exportar horizonte"; se genera `horizon_nina.hzn` con 360 líneas (0–359°)
- Se comparte via `expo-sharing` desde el directorio de documentos del dispositivo

## Permisos
- iOS: `NSMotionUsageDescription`, `NSLocationWhenInUseUsageDescription`
- Android: `ACCESS_FINE_LOCATION`, `ACCESS_COARSE_LOCATION`, lectura/escritura de almacenamiento

## Estructura
- `eas.json`: configuración de build/update
- `app.json`: metadatos de app y permisos
- `src/`: componentes, pantallas, servicios

Aplicación móvil Expo React Native para crear horizontes N.I.N.A. (Nighttime Imaging 'N' Astronomy) utilizando sensores de movimiento del dispositivo.

## Características

- ✅ **Captura de horizonte offline** - No requiere conexión a internet
- ✅ **Sensores de movimiento** - Utiliza DeviceMotion API para orientación precisa
- ✅ **Exportación .hzn** - Genera archivos compatibles con N.I.N.A.
- ✅ **Almacenamiento local** - Gestión de múltiples horizontes
- ✅ **Interfaz intuitiva** - Diseño mobile-first con navegación por tabs
- ✅ **Calibración de sensores** - Validación de precisión antes de captura

## Instalación

```bash
# Clonar el repositorio
git clone <url-del-repositorio>
cd horizon-nina-app

# Instalar dependencias
npm install

# Iniciar el servidor de desarrollo
npm start
```

## Uso

### Desarrollo con Expo Go

1. Descarga la app **Expo Go** en tu dispositivo móvil
2. Escanea el código QR que aparece al ejecutar `npm start`
3. La aplicación se cargará en Expo Go

### Flujo de captura

1. **Iniciar captura**: Presiona "Start New Horizon" y asigna un nombre
2. **Calibrar sensores**: Usa "Calibrate Sensors" si la precisión es baja
3. **Capturar puntos**: Apunta al horizonte y presiona "Capture Point"
4. **Completar**: Cuando tengas suficiente cobertura, presiona "Stop & Save"
5. **Exportar**: Los horizontes se guardan localmente y pueden exportarse como .hzn

## Estructura del Proyecto

```
horizon-nina-app/
├── src/
│   ├── components/          # Componentes React Native
│   │   ├── capture/        # Componentes de captura
│   │   ├── common/         # Componentes comunes
│   │   └── charts/         # Visualizaciones gráficas
│   ├── screens/            # Pantallas principales
│   ├── services/           # Servicios de negocio
│   ├── hooks/              # Hooks personalizados
│   ├── utils/              # Utilidades y cálculos
│   ├── types/              # Definiciones TypeScript
│   ├── constants/          # Constantes de la aplicación
│   └── navigation/         # Configuración de navegación
├── assets/                 # Recursos estáticos
└── App.tsx                 # Punto de entrada principal
```

## Arquitectura

### Servicios principales

- **SensorService**: Gestión de sensores DeviceMotion
- **StorageService**: Almacenamiento con AsyncStorage
- **ExportService**: Generación de archivos .hzn

### Hooks personalizados

- **useDeviceMotion**: Manejo de sensores de movimiento
- **useHorizonData**: Gestión de datos de horizontes

### Tipos de datos

```typescript
interface HorizonPoint {
  azimuth: number;      // 0-360 grados
  altitude: number;     // -90 a 90 grados
  timestamp: number;    // Unix timestamp
  accuracy: number;     // Precisión del sensor
}

interface HorizonData {
  id: string;
  name: string;
  createdAt: number;
  points: HorizonPoint[];
  location?: {
    latitude: number;
    longitude: number;
    altitude?: number;
  };
  metadata: {
    deviceModel: string;
    appVersion: string;
    sensorAccuracy: number;
  };
}
```

## Formato de exportación .hzn

Los archivos .hzn generados siguen el formato estándar de N.I.N.A.:

```
# N.I.N.A. Horizon File
# Generated by Horizon NINA App
# Location: Latitude, Longitude, Altitude
# Date: ISO 8601 Date
# Resolution: degrees
# Points: count

Latitude: 40.7128
Longitude: -74.0060
Altitude: 10
Date: 2024-01-01T12:00:00Z
Resolution: 5.0
Points: 72

# Azimuth(deg) Altitude(deg)
0.0 15.2
5.0 14.8
10.0 16.1
...continúa para 360 grados...
```

## Scripts disponibles

- `npm start` - Inicia el servidor de desarrollo de Expo
- `npm run android` - Ejecuta en Android (requiere Android Studio)
- `npm run ios` - Ejecuta en iOS (requiere macOS y Xcode)
- `npm run web` - Ejecuta en navegador web

## Permisos requeridos

### Android
- `ACCESS_FINE_LOCATION` - Para calibración de brújula
- `ACCESS_COARSE_LOCATION` - Para ubicación general
- `WRITE_EXTERNAL_STORAGE` - Para exportar archivos
- `READ_EXTERNAL_STORAGE` - Para leer archivos exportados

### iOS
- `NSLocationWhenInUseUsageDescription` - Acceso a ubicación
- `NSMotionUsageDescription` - Acceso a sensores de movimiento
- `UIFileSharingEnabled` - Para compartir archivos

## Contribución

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/amazing-feature`)
3. Commit tus cambios (`git commit -m 'Add some amazing feature'`)
4. Push a la rama (`git push origin feature/amazing-feature`)
5. Abre un Pull Request

## Licencia

Este proyecto está bajo la licencia MIT. Ver el archivo `LICENSE` para más detalles.

## Soporte

Para reportar problemas o solicitar características, por favor abre un issue en el repositorio.

---

**Nota**: Esta aplicación está diseñada para funcionar completamente offline y no requiere conexión a internet para capturar horizontes. La exportación de archivos se realiza localmente en el dispositivo.
